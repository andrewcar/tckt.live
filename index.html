<!DOCTYPE html>
<html>
<head>
  <link rel="stylesheet" type="text/css" href="style.css"/>
  Hoods
  <br>
  <A HREF="privacypolicy">Privacy Policy</A>
  <br>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <div id="apple-pay-button" class="apple-pay-button-with-text apple-pay-button-black-with-text">
  </div>
  <script type="text/javascript" src="https://js.stripe.com/v2/"></script>
  <script type="text/javascript">
    Stripe.setPublishableKey('pk_live_lc0mlT8Gdy4YetGNkdMukCvG');
    document.getElementById('apple-pay-button').addEventListener('click', beginApplePay);
      
    function beginApplePay() {
      var paymentRequest = {
        countryCode: 'US',
        currencyCode: 'USD',
        total: {
          label: 'Hoods',
          amount: '19.99'
        }
      };
      
      var session = Stripe.applePay.buildSession(paymentRequest,
        function(result, completion) {

        $.post('/charges.html', { token: result.token.id }).done(function() {
          completion(ApplePaySession.STATUS_SUCCESS);
          // You can now redirect the user to a receipt page, etc.
          //window.location.href = '/success.html';
        }).fail(function() {
          completion(ApplePaySession.STATUS_FAILURE);
        });

      }, function(error) {
        console.log(error.message);
      });

      session.oncancel = function() {
        console.log("User hit the cancel button in the payment window");
      };

      session.begin();
    }
  </script>

</head>
</html>
